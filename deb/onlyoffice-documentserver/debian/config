#!/bin/sh

set -e

. /usr/share/debconf/confmodule

DB_HOST=""
DB_NAME=""
DB_USER=""
DB_PWD=""

db_fset onlyoffice/cluster-mode seen true
db_fset onlyoffice/ds-port seen true
db_fset onlyoffice/docservice-port seen true
db_fset onlyoffice/spellchecker-port seen true
db_fset onlyoffice/example-port seen true
db_fset onlyoffice/jwt-enabled seen true
db_fset onlyoffice/jwt-secret seen true
db_fset onlyoffice/jwt-header seen true

db_input medium onlyoffice/db-host || true
db_input medium onlyoffice/db-name || true
db_input medium onlyoffice/db-user || true
db_go

db_input critical onlyoffice/db-pwd || true
db_go

db_input medium onlyoffice/rabbitmq-host || true
db_input medium onlyoffice/rabbitmq-user || true
db_input medium onlyoffice/rabbitmq-pwd || true

db_input medium onlyoffice/redis-host || true
db_go

db_get onlyoffice/db-host
DB_HOST="$RET"

db_get onlyoffice/db-name
DB_NAME="$RET"

db_get onlyoffice/db-user
DB_USER="$RET"

db_get onlyoffice/db-pwd
DB_PWD="$RET"

exit 0
